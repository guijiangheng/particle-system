!function(t){var i={};function s(o){if(i[o])return i[o].exports;var n=i[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=i,s.d=function(t,i,o){s.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:o})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,i){if(1&i&&(t=s(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)s.d(o,n,function(i){return t[i]}.bind(null,n));return o},s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="",s(s.s=0)}([function(t,i,s){"use strict";s.r(i);class o{constructor(t=0,i=0,s=0){this.x=t,this.y=i,this.z=s}add(t){return new o(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new o(this.x-t.x,this.y-t.y,this.z-t.z)}multiply(t){return new o(this.x*t,this.y*t,this.z*t)}divide(t){return this.multiply(1/t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.lengthSquared())}distanceSquared(t){return this.sub(t).lengthSquared()}distance(t){return this.sub(t).length()}normalize(){return this.divide(this.length())}clone(){return new o(this.x,this.y,this.z)}}class n{constructor(t=new o,i=t){this.position=t,this.prevPosition=i}getVelocity(){return this.position.sub(this.prevPosition)}setVelocity(t){this.prevPosition=this.position.sub(t)}}class r{applyConstraint(){throw new Error("subclass must override this method")}}class e extends r{constructor(t,i){super(),this.particle=t,this.position=void 0===i?t.position.clone():i}applyConstraint(){this.particle.position=this.position.clone()}}class c extends r{constructor(t,i,s=1){super(),this.pMin=t,this.pMax=i,this.bounceFriction=s}applyConstraint(t){const i=t.getVelocity();for(const s of["x","y","z"])t.position[s]<this.pMin[s]?(t.position[s]=this.pMin[s],t.prevPosition[s]=this.pMin[s]+i[s]*this.bounceFriction):t.position[s]>this.pMax[s]&&(t.position[s]=this.pMax[s],t.prevPosition[s]=this.pMax[s]+i[s]*this.bounceFriction)}}class p extends r{constructor(t,i,s){super(),this.particleA=t,this.particleB=i,this.distance=void 0===s?this.particleA.position.distance(this.particleB.position):s}applyConstraint(){let t=this.particleA.position.sub(this.particleB.position),i=t.length();i<1e-4&&(t=new o(.1,0,0),i=.1);const s=(this.distance-i)/i/2,n=t.multiply(s);this.particleA.position=this.particleA.position.add(n),this.particleB.position=this.particleB.position.sub(n)}}class u{constructor(){this.particles=[],this.constraints=[]}pin(t){return this.constraints.push(new e(this.particles[t])),this}applyConstraint(){for(const t of this.constraints)t.applyConstraint()}getIndexBuffer(){return null}getPositionBuffer(){return this.positionBuffer=new Float32Array(3*this.particles.length),this.updatePositionBuffer(),this.positionBuffer}updatePositionBuffer(){let t=0;for(const i of this.particles)this.positionBuffer[t]=i.position.x,this.positionBuffer[t+1]=i.position.y,this.positionBuffer[t+2]=i.position.z,t+=3}}class a extends u{constructor(t){super(),this.particles.push(new n(t))}}class h extends u{constructor(t,i,s,o){super();const r=s-1,e=i.sub(t).divide(r);for(let i=0;i<s;++i)this.particles.push(new n(t.add(e.multiply(i))));for(let t=0;t<r;++t)this.constraints.push(new p(this.particles[t],this.particles[t+1],o/r))}pinFirst(){return this.pin(0)}pinLast(){return this.pin(this.particles.length-1)}getIndexBuffer(){const t=[],i=this.particles.length-1;for(let s=0;s<i;++s)t.push(s,s+1);return new Uint32Array(t)}}class l{applyForce(){throw new Error("subclass must override this method")}}class f extends l{constructor(t){super(),this.force=t}applyForce(t){t.position=t.position.add(this.force)}}class d{constructor(t){this.friction=1,this.iterations=t,this.forces=[],this.constraints=[],this.composites=[]}addComposite(t){this.composites.push(t)}addForce(t){this.forces.push(t)}addConstraint(t){this.constraints.push(t)}updatePositions(){for(const t of this.composites)for(const i of t.particles){const t=i.getVelocity().multiply(this.friction);i.prevPosition=i.position,i.position=i.position.add(t);for(const t of this.forces)t.applyForce(i)}}applyConstraints(){for(const t of this.composites)t.applyConstraint();for(const t of this.composites)for(const i of t.particles)for(const t of this.constraints)t.applyConstraint(i)}updatePositionBuffer(){for(const t of this.composites)t.updatePositionBuffer()}update(){this.updatePositions();for(let t=0;t<this.iterations;++t)this.applyConstraints();this.updatePositionBuffer()}}s.d(i,"Vector3",function(){return o}),s.d(i,"Particle",function(){return n}),s.d(i,"Composite",function(){return u}),s.d(i,"Point",function(){return a}),s.d(i,"Line",function(){return h}),s.d(i,"Force",function(){return l}),s.d(i,"DirectionalForce",function(){return f}),s.d(i,"Constraint",function(){return r}),s.d(i,"PinConstraint",function(){return e}),s.d(i,"BoxConstraint",function(){return c}),s.d(i,"DistanceConstraint",function(){return p}),s.d(i,"ParticleSystem",function(){return d})}]);